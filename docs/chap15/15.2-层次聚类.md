# 层级聚类

## 1. 层次聚类介绍

### 1.1 什么是层次聚类
层次聚类的目标是生成一个层次结构，类似于目录树。这个层次结构是自动创建的，可以通过自顶向下或自底向上的方法来实现。

### 1.2 层次聚类的作用
- 可以得到聚类的层次结构。
- 不需要事先定义簇的个数。

## 2. 层次凝聚式聚类 (HAC)

### 2.1 HAC算法概述
- 最著名的自底向上的方法是层次凝聚式聚类 (Hierarchical Agglomerative Clustering, HAC)。
- HAC会生成一棵二叉树形式的类别层次结构。
- 初始时，每篇文档作为一个独立的簇，然后不断合并最相似的两个簇，直至仅剩一个簇。

### 2.2 HAC算法步骤
1. **初始化**：每篇文档作为一个独立的簇。
2. **合并最相似的两个簇**：计算所有簇之间的相似度，找到最相似的两个簇并合并。
3. **更新相似度矩阵**：合并后，重新计算新簇与其他簇之间的相似度。
4. **重复步骤2和3**：直到所有文档合并成一个簇。

### 2.3 HAC算法的计算复杂度
- 首先，需要计算 \(N \times N\) 个文档对之间的相似度。
- 其次，在 \(N\) 次迭代的每一次迭代中：
  - 扫描 \(O(N \times N)\) 个相似度来寻找最大相似度。
  - 合并具有最大相似度的两个簇。
  - 计算合并后的簇和先前其他簇之间的相似度。
- 整体复杂度为 \(O(N^3)\)。

## 3. 簇相似度计算方法

### 3.1 单连接 (Single-link)
- **定义**：两个簇的相似度等于最大的类间相似度。
- **更新相似度矩阵**：
  \[
  SIM(\omega_i, (\omega_{k1} \cup \omega_{k2})) = \max(SIM(\omega_i, \omega_{k1}), SIM(\omega_i, \omega_{k2}))
  \]
- **特点**：容易产生链式效应，导致长而凌乱的簇结构。

### 3.2 全连接 (Complete-link)
- **定义**：两个簇的相似度等于最小的类间相似度。
- **更新相似度矩阵**：
  \[
  SIM(\omega_i, (\omega_{k1} \cup \omega_{k2})) = \min(SIM(\omega_i, \omega_{k1}), SIM(\omega_i, \omega_{k2}))
  \]
- **特点**：对离群点非常敏感，但能避免链式效应。

### 3.3 质心法 (Centroid)
- **定义**：簇相似度为所有簇间文档对之间相似度的平均值。
- **更新相似度矩阵**：计算两个簇质心之间的相似度。
- **特点**：计算效率较高，但可能受到质心选择的影响。

### 3.4 组平均 (Group-average)
- **定义**：簇之间的相似度是所有文档对之间相似度的平均值（包括来自同一簇的文档）。
- **更新相似度矩阵**：基于质心定义的高效算法。
- **特点**：不会受限于链式效应，对离群点不敏感。

## 4. 簇标签生成

### 4.1 簇标签生成的重要性
- 聚类算法结束后，需要为每个簇生成一个简洁精炼的标签，以便用户理解。
- 标签可以是词语、短语或标题。

### 4.2 非差别式簇标签生成方法
- **定义**：只基于簇本身的信息来选择词项或短语。
- **示例**：质心向量中高权重的词项。
- **缺点**：有时会选出并不能区分簇的高频词项。

### 4.3 差别式簇标签生成方法
- **定义**：为了对簇 \(\omega\) 生成标签，将 \(\omega\) 和其他簇进行比较，找到那些将 \(\omega\) 和其他簇区别开的词项或短语。
- **示例**：使用互信息、\(\chi^2\) 或词频等特征选择方法。

### 4.4 使用标题生成簇标签
- **定义**：使用最接近质心的几篇文档的标题作为簇标签。
- **优点**：标题比一系列短语的可读性更强。

## 5. 本讲小结
- 层次聚类的概念和作用。
- 层次凝聚式聚类 (HAC) 算法的步骤和计算复杂度。
- 不同的簇相似度计算方法及其特点。
- 簇标签生成的方法和重要性。