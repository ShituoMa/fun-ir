# 扁平聚类

## 1. 聚类介绍

### 1.1 什么是聚类
聚类是将一系列对象按照相似性聚团成子集或者簇(cluster)的过程。簇内文档之间彼此相似，簇间文档之间相似度不大。

### 1.2 聚类示例
聚类是一种最常见的无监督学习(unsupervised learning)方法，无监督意味着没有已标注好的数据集。

## 2. 聚类在IR中的应用

### 2.1 搜索引擎中的应用
- **查询的聚类**：发现用户的潜在意图。
- **搜索结果的聚类**：更好地浏览返回结果。

### 2.2 文档聚类用于提高召回率
- 为提高搜索召回率，可以事先将文档集中的文档进行聚类。
- 当文档d和查询匹配时，也返回包含d的簇所包含的其他文档。

## 3. K-均值聚类算法

### 3.1 算法介绍
K-均值聚类算法是最著名的聚类算法之一，算法十分简单，但在很多情况下效果不错。它是文档聚类的默认或基准算法。

### 3.2 聚类中的文档表示
- 采用向量空间模型，使用欧氏距离计算向量之间的相关性。

### 3.3 K-均值聚类算法步骤
- **重分配(reassignment)**：将每篇文档分配给离它最近的簇。
- **重计算(recomputation)**：重新计算每个簇的质心向量。

### 3.4 算法的终止条件
- 当迭代一个固定次数后停止。
- 当文档到簇的分配结果不再改变后停止。
- 当质心向量不再改变后停止。

### 3.5 算法的时间复杂度
- 计算两个向量的距离的时间复杂度为O(M)。
- 重分配过程: O(KNM)。
- 重计算过程：O(NM)。
- 整体复杂度: O(IKNM)。

### 3.6 算法的收敛性和最优性
- K-均值聚类算法一定是收敛的，但不知道达到收敛所需要的时间。
- 收敛并不意味着会达到全局最优的聚类结果。

### 3.7 算法的初始化
- 种子的随机选择只是K-均值聚类算法的一种初始化方法之一。
- 一些确定初始质心向量的更好办法：非随机地采用某些启发式方法来选择种子，采用层级聚类算法寻找好的种子。

### 3.8 K-means++：K-means初始化方法的改进
- 种子选择原则：聚类中心尽可能离得远。
- 步骤一：随机选取一个样本作为第一个聚类中心c1。
- 步骤二：计算每个样本与当前已有聚类中心最短距离，用D(x)表示；接着计算每个样本被选为聚类中心的概率，最后用轮盘法选出下一个聚类中心。
- 步骤三：重复步骤二，直至选出k个聚类中心。

## 4. 聚类评价

### 4.1 内部准则(Internal criteria)
- 一个内部准则的例子：K-均值聚类算法的RSS值。
- 但是内部准则往往不能评价聚类在应用中的实际效用。

### 4.2 外部准则(External criteria)
- 按照用户定义的分类结果来评价，即对一个分好类的数据集进行聚类，将聚类结果和事先的类别情况进行比照，得到最后的评价结果。

### 4.3 外部准则: 纯度
- Ω= {ω1, ω2, . . . , ωK} 是簇的集合。
- C = {c1, c2, . . . , cJ} 是类别的集合。
- 对每个簇ωk: 找到一个类别cj，该类别包含ωk中的元素最多，为nkj个。
- 将所有nkj求和，然后除以所有的文档数目。

### 4.4 外部准则：兰迪指数(Rand index)
- 定义：考虑所有两个文档之间(文档对)的关系，可以得到2x2的列联表。
- 总的文档对数目为TP+FN+FP+TN。
- 对于N篇文档，总共有N*(N-1)/2个文档对。

## 5. 簇个数确定

### 5.1 簇个数的确定方法
- 在很多应用中，簇个数K是事先给定的。
- 如果没有外部的限制，可以定义一个优化准则，给定文档，找到达到最优情况的K值。

### 5.2 简单的目标函数
- 基本思路：从1个簇开始(K = 1)，不断增加簇(不断增大K)，对每个新的簇增加一个惩罚项，在惩罚项和RSS之间折中，选择满足最佳折中条件的K。

## 6. 其他聚类算法

### 6.1 DBSCAN
- DBSCAN (Density-Based Spatial Clustering of Applications with Noise)算法将具有足够密度的区域划分为簇。
- 和传统的K-Means算法相比，DBSCAN最大的不同是不需要输入类别数k。
- 优点是可以发现任意形状的聚类簇，可以在聚类的同时发现异常点，对数据集中的异常点不敏感。
- 缺点是如果样本集的密度不均匀、聚类间距差相差很大时，聚类质量较差。

### 6.2 谱聚类
- 谱聚类(Spectral Clustering, SC)是一种基于图论的聚类方法。
- 文本可以表示为图的形式，比如可以把整个文档当做顶点，文档和文档间的相似度作为连边的权重，也可以把文档中的关键词作为顶点，关键词间的关联关系作为连边，然后用基于图的聚类方法。

## 7. 本讲小结
- 聚类的概念(What is clustering?)
- 聚类在IR中的应用
- K-均值(K-Means)聚类算法
- 聚类评价
- 簇(cluster)个数(即聚类的结果类别个数)确定